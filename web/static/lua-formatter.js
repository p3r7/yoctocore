!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.LuaFormatter=t():e.LuaFormatter=t()}(this,(()=>(()=>{var e={987:(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=n(618);function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i(i({},{RenameVariables:!1,RenameGlobals:!1,SolveMath:!1,Indentation:"\t"}),t);try{return l.Beautify(e,n)}catch(e){return console.error("Error beautifying Lua code:",e),null}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i(i({},{RenameVariables:!1,RenameGlobals:!1,SolveMath:!1}),t);try{return l.Minify(e,n)}catch(e){return console.error("Error minifying Lua code:",e),null}}"undefined"!=typeof window&&(window.LuaFormatter={beautifyLua:s,minifyLua:u}),e.exports={beautifyLua:s,minifyLua:u}},618:(e,t,n)=>{const o=n(798);t.Beautify=o.Beautify,t.Minify=o.Minify,t.Uglify=o.Uglify},798:(e,t,n)=>{e=n.nmd(e);const o=console.log,r=(console.error,function(e,t){if(!e)throw t});function i(e,t){if(!e)return 0;var n=e.toString().split(".");return n.length>1?parseInt(n[0],t)+parseInt(n[1],t)/Math.pow(t,n[1].length):parseInt(n[0],t)}let a=[" ","\n","\t","\r"];const l=new Proxy({r:"\r",n:"\n",t:"\t",'"':'"',"'":"'","\\":"\\"},{get:(e,t)=>i(t)});let s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],u=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","a","b","c","d","e","f","g","t","u","v","w","h","i","j","k","l","m","n","o","p","q","r","s","x","y","z"],T=["0","1","2","3","4","5","6","7","8","9"],p=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","A","B","C","D","E","F"],c=["0","1"],f=["+","-","*",")",";","/","^","%","#",",","{","}",":","[","]","(",".","`"],k=["~","=",">","<"],y=["+","-","*","/","^","..","%","//"],L=["+=","-=","*=","/=","^=","..=","%=","//="],h=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","continue"],S=["else","elseif","until","end"],d=["-","not","#","~"],E=["+","-","*","/","%","^","#","//","&","|","~","<<",">>","..",".",":",">","<","<=",">=","~=","==","+=","-=","*=","/=","%=","^=","..=","//=","and","or"],m={"^":[13,12],"%":[10,10],"//":[10,10],"/":[10,10],"*":[10,10],"+":[9,9],"-":[9,9],"..":[8,7],">>":[7,7],"<<":[7,7],"&":[6,6],"~":[5,5],"|":[4,4],"==":[3,3],"~=":[3,3],">=":[3,3],"<=":[3,3],">":[3,3],"<":[3,3],"+=":[3,3],"-=":[3,3],"*=":[3,3],"/=":[3,3],"^=":[3,3],"%=":[3,3],"..=":[3,3],"//=":[3,3],and:[2,2],or:[1,1]};function _(e){let t,n,i=function(e){let t=0,n=e.length,r=[];function i(o){return o=o||0,t<=n?e.substr(t+o,1):""}function L(){if(t<=n){let n=e.substr(t,1);return t++,n}return""}function S(n){let i,a=1,l=1;for(;0<=t;)"\n"==e.substr(0,1)?(a++,l=1):l++;for(i=0;i<r.length;i++){let e=r[i];o(`${e.Type}<${e.Source}>`)}throw`file<${a}:${l}>: ${n}`}function d(e){for(;;){let n=L();if(""==n)S("Unfinished long string.");else if("]"==n){let n,o=!0;for(n=1;n<=e;n++){if("="!=i()){o=!1;break}t++}if(o&&"]"==L())return}}}function m(){let e=t;for(;"="==i();)t++;return"["==i()?(t++,t-e-1):void(t=e)}let _=0,g=0;function C(n){let o=e.substr(g,t-g),i=null;"Number"==n&&("0x"==o.substr(0,2).toLowerCase()?(i="hex",parseInt(o,16)<999999999999&&(o=parseInt(o,16))):"0b"==o.substr(0,2).toLowerCase()&&(i="bin",parseInt(o.substr(2),2)<999999999999&&(o=parseInt(o.substr(2),2))));let a={Type:n,LeadingWhite:e.substr(_,g-_),Source:o};return null!==i&&(a.NType=i),r.push(a),_=t,g=t,a}for(;;){for(_=t;;){let e=i();if(""==e)break;if("-"==e){if("-"!=i(1))break;if(t+=2,"["==i()){t++;let e=m();if(null!=e)d(e),_=t;else for(;;){let e=L();if(""==e||"\n"==e)break}}else for(;;){let e=L();if(""==e||"\n"==e)break}}else{if(!a.includes(e))break;t++}}e.substr(_,t-_),g=t;let n=L();if(""==n){C("Eof");break}if("'"==n||'"'==n){for(;;){let e=L();if("\\"==e){let e=L();if(null==l[e])throw`Invalid Escape Sequence \`${e}\`.`}else{if(e==n)break;if(""==e)throw"Unfinished string!"}}C("String")}else if("`"==n){for(;;){let e=L();if("\\"==e){let e=L();if(null==l[e])throw`Invalid Escape Sequence \`${e}\`.`}else{if(e==n)break;if(""==e)throw"Unfinished string!"}}C("Hash")}else if(s.includes(n)){for(;u.includes(i());)t++;h.includes(e.substr(g,t-g))?C("Keyword"):C("Ident")}else if(T.includes(n)||"."==n&&T.includes(i())){if("0"==n&&"x"==i().toLowerCase())for(t++;p.includes(i())||"_"===i();)t++;else if("0"==n&&"b"==i().toLowerCase())for(t++;c.includes(i())||"_"===i();)t++;else{for(;T.includes(i())||"_"===i();)t++;if("."==i())for(t++;T.includes(i());)t++;if("e"==i()||"E"==i())for(t++,"-"!=i()&&"+"!=i()||t++;T.includes(i());)t++}C("Number")}else if("["==n){let e=m();null!=e?(d(e),C("String")):C("Symbol")}else if("."==n)"."==i()&&(L(),("."==i()||"="==i())&&L()),C("Symbol");else if(n+i()=="//")L(),"="==i()&&L(),C("Symbol");else if(n+i()=="::")L(),C("Symbol");else if(E.includes(n+i()))L(),C("Symbol");else if(k.includes(n))"="==i()&&t++,C("Symbol");else if(y.includes(n)&&"="==i())L(),C("Symbol");else{if(!f.includes(n))throw`Bad symbol \`${n}\` in source. ${t}`;C("Symbol")}}return r}(e),_=0;function g(){let e=i[_];return _<i.length&&_++,e}function C(e){return i[e=_+(e||0)]||i[i.length-1]}function F(e){let t=1,n=0,o=0;for(;;){let r,a,l=i[o];for(r=l==e?l.LeadingWhite:l.LeadingWhite+l.Source,a=0;a<=r.length;a++)"\n"==r.substr(a,1)?(t++,n=0):n++;if(l==e)break;o++}return`${t}:${n+1}`}function b(){let e=C();return"Eof"==e.Type||"Keyword"==e.Type&&S.includes(e.Source)}function x(e,t){let n=C();if(n.Type!=e||null!=t&&n.Source!=t){let r;for(r=-3;r<=3;r++)o(`Tokens[${r}] = \`${C(r).Source}\``);if(t)throw`${F(n)}: \`${t}\` expected.`;throw`${F(n)}: ${e} expected.`}return g()}function B(e){let t=e.GetFirstToken,n=e.GetLastToken,o=e;return e.GetFirstToken=function(){let e=t(o);return r(e),e},e.GetLastToken=function(){let e=n(o);return r(e),e},e}function G(e,t){let o=[n(e,t)],r=[];for(;","==C().Source;)r.push(g()),o.push(n(e,t));return[o,r]}function R(e,t){let n=[],o=[];if("Ident"==C().Type){let e=g();if(t&&"<"==C().Source&&">"==C(2).Source){let t=C(1).Source;e.Attribute={LeadingWhite:C().LeadingWhite,Source:`<${t}>`},g(),g(),g()}n.push(e)}else if("..."==C().Source&&e)return[n,o,g()];for(;","==C().Source;){if(o.push(g()),"..."==C().Source&&e)return[n,o,g()];{let e=x("Ident");if(t&&"<"==C().Source&&">"==C(2).Source){let t=C(1).Source;e.Attribute={LeadingWhite:C().LeadingWhite,Source:`<${t}>`},g(),g(),g()}n.push(e)}}return[n,o]}function V(e,n,r){let i=t(n,r),a=C();if("Keyword"==a.Type&&a.Source==e)return g(),[i,a];throw o(a.Type,a.Source),`${F(a)}: ${e} expected.`}function A(e,t,n,o){let r,i,a=g();if(!e){r=[],i=[];let e=x("Ident");for(r.push(e);"."==C().Source;)i.push(g()),r.push(x("Ident"));":"==C().Source&&(i.push(g()),r.push(x("Ident")))}let l,s=x("Symbol","("),[u,T,p]=R(!0),c=x("Symbol",")"),[f,k]=V("end",t,n);return l=B({Type:1==e?"FunctionLiteral":"FunctionStat",NameChain:r,ArgList:u,Body:f,Token_Function:a,Token_NameChainSeperator:i,Token_OpenParen:s,Token_Varg:p,Token_ArgCommaList:T,Token_CloseParen:c,Token_End:k,GetFirstToken:()=>l.Token_Function,GetLastToken:()=>l.Token_End}),l}function N(e,t){let o=C();if("("==o.Source){let o=g(),r=[],i=[];for(;")"!=C().Source&&(r.push(n(e,t)),","==C().Source);)i.push(g());let a,l=x("Symbol",")");return a=B({CallType:"ArgCall",ArgList:r,Token_CommaList:i,Token_OpenParen:o,Token_CloseParen:l,GetFirstToken:()=>a.Token_OpenParen,GetLastToken:()=>a.Token_CloseParen}),a}if("{"==o.Source){let o;return o=B({CallType:"TableCall",TableExpr:n(e,t),GetFirstToken:()=>o.TableExpr.GetFirstToken(),GetLastToken:()=>o.TableExpr.GetLastToken()}),o}if("String"==o.Type){let e;return e=B({CallType:"StringCall",Token:g(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}throw"Function arguments expected."}function I(e,t){let i=function(e,t){let r=C();if("("==r.Source){let o,r=g(),i=n(e,t),a=x("Symbol",")");return o=B({Type:"ParenExpr",Expression:i,Token_OpenParen:r,Token_CloseParen:a,GetFirstToken:()=>o.Token_OpenParen,GetLastToken:()=>o.Token_CloseParen}),o}if("Ident"==r.Type){let n;return n=B({Type:"VariableExpr",Token:g(),GetFirstToken:()=>n.Token,GetLastToken:()=>n.Token}),null!=e[n.Token.Source]&&null!=e[n.Token.Source]?.Tokens?.push?(e[n.Token.Source].Tokens.push(n.Token),e[n.Token.Source].UseCountIncrease()):null!=t[n.Token.Source]&&null!=t[n.Token.Source]?.Tokens?.push&&(t[n.Token.Source].Tokens.push(n.Token),t[n.Token.Source].UseCountIncrease()),n}throw o(function(){let e=C();return`<${e.Type} \`${e.Source}\`> at: ${F(e)}`}()),`${F(r)}: Unexpected symbol. ${r.Type} ${r.Source}`}(e,t);for(r(i,"nil prefixexpr");;){let o=C();if("."==o.Source){let e,t=g(),n=x("Ident");e=B({Type:"FieldExpr",Base:i,Field:n,Token_Dot:t,GetFirstToken:()=>e.Base.GetFirstToken(),GetLastToken:()=>e.Field}),i=e}else if(":"==o.Source){let n,o=g(),r=x("Ident"),a=N(e,t);n=B({Type:"MethodExpr",Base:i,Method:r,FunctionArguments:a,Token_Colon:o,GetFirstToken:()=>n.Base.GetFirstToken(),GetLastToken:()=>n.FunctionArguments.GetLastToken()}),i=n}else if("["==o.Source){let o,r=g(),a=n(e,t),l=x("Symbol","]");o=B({Type:"IndexExpr",Base:i,Index:a,Token_OpenBracket:r,Token_CloseBracket:l,GetFirstToken:()=>o.Base.GetFirstToken(),GetLastToken:()=>o.Token_CloseBracket}),i=o}else if("{"==o.Source||"("==o.Source||"String"==o.Type){let n;n=B({Type:"CallExpr",Base:i,FunctionArguments:N(e,t),GetFirstToken:()=>n.Base.GetFirstToken(),GetLastToken:()=>n.FunctionArguments.GetLastToken()}),i=n}else{if(!L.includes(o.Source))return i;{let o,r=g(),a=n(e,t);o=B({Type:"CompoundStat",Base:i,Token_Compound:r,Rhs:a,Lhs:i,GetFirstToken:()=>o.Base.GetFirstToken(),GetLastToken:()=>o.Rhs.GetLastToken()}),i=o}}}}function P(e,t,o){let i;if(d.includes(C().Source)){let e,n=g(),r=P(11,t,o);e=B({Type:"UnopExpr",Token_Op:n,Rhs:r,GetFirstToken:()=>e.Token_Op,GetLastToken:()=>e.Rhs.GetLastToken()}),i=e}else i=function(e,t){let o=C();if("Number"==o.Type){let e;return e=B({Type:"NumberLiteral",Token:g(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("String"==o.Type){let e;return e=B({Type:"StringLiteral",Token:g(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("Hash"==o.Type){let e;return e=B({Type:"HashLiteral",Token:g(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("nil"==o.Source){let e;return e=B({Type:"NilLiteral",Token:g(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("true"==o.Source||"false"==o.Source){let e;return e=B({Type:"BooleanLiteral",Token:g(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("..."==o.Source){let e;return e=B({Type:"VargLiteral",Token:g(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}return"{"==o.Source?function(e,t){let o=x("Symbol","{"),r=[],i=[];for(;"}"!=C().Source;){let o,a;if("["==C().Source){let i=g(),l=n(e,t),s=x("Symbol","]"),u=x("Symbol","="),T=n(e,t);o=l.Token&&l.Token.Source,a=T,r.push({EntryType:"Index",Index:l,Value:T,Token_OpenBracket:i,Token_CloseBracket:s,Token_Equals:u})}else if("Ident"==C().Type&&"="==C(1).Source){let i=g(),l=g(),s=n(e,t);o=i,a=s,r.push({EntryType:"Field",Field:i,Value:s,Token_Equals:l})}else{let o=n(e,t);r.push({EntryType:"Value",Value:o})}if(","!=C().Source&&";"!=C().Source)break;i.push(g())}let a,l=x("Symbol","}");return a=B({Type:"TableLiteral",EntryList:r,Token_SeperatorList:i,Token_OpenBrace:o,Token_CloseBrace:l,GetFirstToken:()=>a.Token_OpenBrace,GetLastToken:()=>a.Token_CloseBrace}),a}(e,t):"function"==o.Source?A(!0,e,t):I(e,t)}(t,o),r(i,"nil sipleexpr");for(;E.includes(C().Source)&&null!=m[C().Source]&&m[C().Source][0]>e;){let e,n=g(),a=P(m[n.Source][1],t,o);r(a,"RhsNeeded"),e=B({Type:"BinopExpr",Lhs:i,Rhs:a,Token_Op:n,GetFirstToken:()=>e.Lhs.GetFirstToken(),GetLastToken:()=>e.Rhs.GetLastToken()}),i=e}return i}function O(e,t){let o=I(e,t);if("MethodExpr"==o.Type||"CallExpr"==o.Type){let e;return e=B({Type:"CallExprStat",Expression:o,GetFirstToken:()=>e.Expression.GetFirstToken(),GetLastToken:()=>e.Expression.GetLastToken()}),e}if("CompoundStat"==o.Type)return o;{let r=[o],i=[];for(;","==C().Source;){i.push(g());let n=I(e,t);if("MethodExpr"==n.Type||"CallExpr"==n.Type)throw"Bad left hand side of asignment";r.push(n)}let a,l=x("Symbol","="),s=[n(e,t)],u=[];for(;","==C().Source;)u.push(g()),s.push(n(e,t));return a=B({Type:"AssignmentStat",Rhs:s,Lhs:r,Token_Equals:l,Token_LhsSeperatorList:i,Token_RhsSeperatorList:u,GetFirstToken:()=>a.Lhs[0].GetFirstToken(),GetLastToken:()=>a.Rhs[a.Rhs.length-1].GetLastToken()}),a}}function v(e,o){let r=g(),i=n(e,o),a=x("Keyword","then"),l=t(e,o),s=[];for(;"elseif"==C().Source||"else"==C().Source;){let r,i,a=g();"elseif"==a.Source&&(r=n(e,o),i=x("Keyword","then"));let l=t(e,o);if(s.push({Condition:r,Body:l,ClauseType:a.Source,Token:a,Token_Then:i}),"else"==a.Source)break}let u,T=x("Keyword","end");return u=B({Type:"IfStat",Condition:i,Body:l,ElseClauseList:s,Token_If:r,Token_Then:a,Token_End:T,GetFirstToken:()=>u.Token_If,GetLastToken:()=>u.Token_End}),u}function w(e,t){let n,o=g(),[r,i]=V("end",e,t);return n=B({Type:"DoStat",Body:r,Token_Do:o,Token_End:i,GetFirstToken:()=>n.Token_Do,GetLastToken:()=>n.Token_End}),n}function $(e,t){let o,r=g(),i=n(e,t),a=x("Keyword","do"),[l,s]=V("end",e,t);return o=B({Type:"WhileStat",Condition:i,Body:l,Token_While:r,Token_Do:a,Token_End:s,GetFirstToken:()=>o.Token_While,GetLastToken:()=>o.Token_End}),o}function D(e,t){let n=g(),[o,r]=R();if("="==C().Source){let i=g(),[a,l]=G(e,t);if(a.length<2||a.length>3)throw"Expected 2 or 3 values for range bounds";let s,u=x("Keyword","do"),[T,p]=V("end",e,t);return s=B({Type:"NumericForStat",VarList:o,RangeList:a,Body:T,Token_For:n,Token_VarCommaList:r,Token_Equals:i,Token_RangeCommaList:l,Token_Do:u,Token_End:p,GetFirstToken:()=>s.Token_For,GetLastToken:()=>s.Token_End}),s}if("in"==C().Source){let i,a=g(),[l,s]=G(e,t),u=x("Keyword","do"),[T,p]=V("end",e,t);return i=B({Type:"GenericForStat",VarList:o,GeneratorList:l,Body:T,Token_For:n,Token_VarCommaList:r,Token_In:a,Token_GeneratorCommaList:s,Token_Do:u,Token_End:p,GetFirstToken:()=>i.Token_For,GetLastToken:()=>i.Token_End}),i}}function U(e,t){let o,r=g(),[i,a]=V("until",e),l=n(e,t);return o=B({Type:"RepeatStat",Body:i,Condition:l,Token_Repeat:r,Token_Until:a,GetFirstToken:()=>o.Token_Repeat,GetLastToken:()=>o.Condition.GetLastToken()}),o}function W(e,t){let n=g();if("function"==C().Source){let o,r=A(!1,e,t);if(r.NameChain.length>1)throw F(r.Token_NameChainSeperator[0])+": `(` expected.";return o=B({Type:"LocalFunctionStat",FunctionStat:r,Token_Local:n,GetFirstToken:()=>o.Token_Local,GetLastToken:()=>o.FunctionStat.GetLastToken()}),o}if("Ident"==C().Type){let o,r,[i,a]=R(!1,!0),l=[],s=[];if("="==C().Source){o=g();let[n,r]=G(e,t);l=n,s=r}return r=B({Type:"LocalVarStat",VarList:i,ExprList:l,Token_Local:n,Token_Equals:o,Token_VarCommaList:a,Token_ExprCommaList:s,GetFirstToken:()=>r.Token_Local,GetLastToken:function(){return r.ExprList.length>0?r.ExprList[r.ExprList.length-1].GetLastToken():r.VarList[r.VarList.length-1]}}),r}throw"`function` or ident expected"}function M(e,t){let n,o,r,i=g();return b()||";"==C().Source?(n=[],o=[]):[n,o]=G(e,t),r={Type:"ReturnStat",ExprList:n,Token_Return:i,Token_CommaList:o,GetFirstToken:()=>r.Token_Return,GetLastToken:function(){return r.ExprList.length>0?r.ExprList[r.ExprList.length-1].GetLastToken():r.Token_Return}},r}function q(e,t){let n,o=g();return n={Type:"BreakStat",Token_Break:o,GetFirstToken:()=>n.Token_Break,GetLastToken:()=>n.Token_Break},n}function j(e,t){let n,o=g();return n={Type:"ContinueStat",Token_Continue:o,GetFirstToken:()=>n.Token_Continue,GetLastToken:()=>n.Token_Continue},n}function H(){let e,t,n=g();return e="Keyword"==C().Type?x("Keyword"):x("Ident"),t={Type:"GotoStat",Token_Goto:n,Token_Label:e,GetFirstToken:()=>t.Token_Goto,GetLastToken:()=>t.Token_Label},t}function K(){let e,t=g();e="Keyword"==C().Type?x("Keyword"):x("Ident");let n,o=x("Symbol","::");return n={Type:"LabelStat",Token_ColonsLeft:t,Token_Label:e,Token_ColonsRight:o,GetFirstToken:()=>n.Token_ColonsLeft,GetLastToken:()=>n.Token_ColonsRight},n}function z(e,t){let n=C();return"if"==n.Source?[!1,v(e,t)]:"while"==n.Source?[!1,$(e,t)]:"do"==n.Source?[!1,w(e,t)]:"for"==n.Source?[!1,D(e,t)]:"repeat"==n.Source?[!1,U(e,t)]:"function"==n.Source?[!1,A(!1,e,t)]:"local"==n.Source?[!1,W(e,t)]:"return"==n.Source?[!0,M(e,t)]:"break"==n.Source?[!0,q()]:"continue"==n.Source?[!0,j()]:"goto"==n.Source?[!1,H()]:"::"==n.Source?[!1,K()]:[!1,O(e,t)]}return n=(e,t)=>P(0,e,t),t=function(e,t){let n,r=[],i=[],a={},l={};if(null!=t)for(let[p,c]of Object.entries(t))l[p]=c;if(null!=e)for(let[f,k]of Object.entries(e))l[f]=k;let s,u=0;for(;!b();){n&&n==C()&&o(`INFINITE LOOP POSSIBLE ON STATEMENT ${n.Source} :`,n),n=C();let[y,L]=z(a,l);if(L)switch(r.push(L),L.Type){case"LocalVarStat":L.VarList.forEach((e=>{e.UseCount=0,e.Number=u++,a[e.Source]=e;let t=[];function n(){e.UseCount++,t.forEach((t=>{t.UseCount=e.UseCount}))}e.Tokens={},e.Tokens.push=o=>{o.UseCountIncrease=n,o.UseCount=e.UseCount,o.Tokens=e.Tokens,t.push(o)},e.Tokens.get=()=>t,e.UseCountIncrease=n}));break;case"LocalFunctionStat":let S=L.FunctionStat.NameChain;if(1===S.length){let d=S[0];d.UseCount=0,d.Number=u++,a[d.Source]=d;let E=[];function T(){d.UseCount++,E.forEach((e=>{e.UseCount=d.UseCount}))}d.Tokens={},d.Tokens.push=e=>{e.UseCountIncrease=T,e.UseCount=d.UseCount,e.Tokens=d.Tokens,E.push(e)},d.Tokens.get=()=>E,d.UseCountIncrease=T}}let h=C();"Symbol"==h.Type&&";"==h.Source&&(i[r.length-1]=g())}return s={Type:"StatList",StatementList:r,SemicolonList:i,GetFirstToken:function(){return 0==s.StatementList.length?void 0:s.StatementList[0]?.GetFirstToken()},GetLastToken:function(){return 0==s.StatementList.length?void 0:s.SemicolonList[s.StatementList.length-1]?s.SemicolonList[s.StatementList.length-1]:s.StatementList[s.StatementList.length-1].GetLastToken()}},s},t([],[])}function g(e,t){let n,o,r={BinopExpr:!0,UnopExpr:!0,NumberLiteral:!0,StringLiteral:!0,NilLiteral:!0,BooleanLiteral:!0,VargLiteral:!0,HashLiteral:!0,FieldExpr:!0,IndexExpr:!0,MethodExpr:!0,CallExpr:!0,FunctionLiteral:!0,VariableExpr:!0,ParenExpr:!0,TableLiteral:!0},i={StatList:!0,BreakStat:!0,ContinueStat:!0,LabelStat:!0,GotoStat:!0,ReturnStat:!0,LocalVarStat:!0,LocalFunctionStat:!0,FunctionStat:!0,RepeatStat:!0,GenericForStat:!0,NumericForStat:!0,WhileStat:!0,DoStat:!0,IfStat:!0,CallExprStat:!0,AssignmentStat:!0,CompoundStat:!0};for(var[a,l]of Object.entries(t))if(!i[a]&&!r[a])throw`Invalid visitor target: \`${a}\``;function s(e){if(null!=e){let n=t[e.Type];if("function"==typeof n)return n(e);if(n&&n.Pre)return n.Pre(e)}}function u(e){let n=t[e.Type];if(n&&"object"==typeof n&&n.Post)return n.Post(e)}n=function(e){if(!s(e)){if("BinopExpr"==e.Type)n(e.Lhs),n(e.Rhs);else if("UnopExpr"==e.Type)n(e.Rhs);else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type);else if("FieldExpr"==e.Type)n(e.Base);else if("IndexExpr"==e.Type)n(e.Base),n(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)n(e.Base),"ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach(((e,t)=>{n(e)})):"TableCall"==e.FunctionArguments.CallType&&n(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)o(e.Body);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type)n(e.Expression);else if("TableLiteral"==e.Type)e.EntryList.forEach(((e,t)=>{if("Field"==e.EntryType)n(e.Value);else if("Index"==e.EntryType)n(e.Index),n(e.Value);else{if("Value"!=e.EntryType)throw"unreachable";n(e.Value)}}));else{if("CompoundStat"!=e.Type)throw`unreachable, type: ${e.Type}: ${e}`;n(e.Lhs),n(e.Rhs)}u(e)}},o=function(e){if(!s(e)){if("StatList"==e.Type)e.StatementList.forEach(((t,n)=>{if(null!=t){if(null===t||null===t.Type)return;t.Remove=()=>{e.StatementList[n]=null},o(t)}}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("GotoStat"==e.Type);else if("LabelStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach(((e,t)=>{n(e)}));else if("LocalVarStat"==e.Type)e.Token_Equals&&e.ExprList.forEach(((e,t)=>{n(e)}));else if("LocalFunctionStat"==e.Type)o(e.FunctionStat.Body);else if("FunctionStat"==e.Type)o(e.Body);else if("RepeatStat"==e.Type)o(e.Body),n(e.Condition);else if("GenericForStat"==e.Type)e.GeneratorList.forEach(((e,t)=>{n(e)})),o(e.Body);else if("NumericForStat"==e.Type)e.RangeList.forEach(((e,t)=>{n(e)})),o(e.Body);else if("WhileStat"==e.Type)n(e.Condition),o(e.Body);else if("DoStat"==e.Type)o(e.Body);else if("IfStat"==e.Type)n(e.Condition),o(e.Body),e.ElseClauseList.forEach((e=>{null!=e.Condition&&n(e.Condition),o(e.Body)}));else if("CallExprStat"==e.Type)n(e.Expression);else if("CompoundStat"==e.Type)n(e.Lhs),n(e.Rhs);else{if("AssignmentStat"!=e.Type)throw"unreachable";e.Lhs.forEach((e=>{n(e)})),e.Rhs.forEach((e=>{n(e)}))}u(e)}},i[e.Type]?o(e):n(e)}function C(e){let t,n=[],o=0;function i(){return o++,o}function a(){t={ParentScope:t,ChildScopeList:[],VariableList:[],BeginLocation:i(),Depth:null,GetVar:null},t.ParentScope?(t.Depth=t.ParentScope.Depth+1,t.ParentScope.ChildScopeList.push(t)):t.Depth=1;let e=t;t.GetVar=function(t){for(const n of e.VariableList)if(n.Name==t)return n;if(e.ParentScope)return e.ParentScope.GetVar(t);for(const e of n)if(e.Name==t)return e}}function l(){let e=t;return e.EndLocation=i(),e.VariableList.forEach((t=>{t.ScopeEndLocation=e.EndLocation})),t=e.ParentScope,e}function s(e,n,o){r(o,"MIssing localInfo"),r(e,"Missing local var name");let a={Type:"Local",Name:e,RenameList:[n],AssignedTo:!1,Info:o,Scope:t,BeginLocation:i(),EndLocation:i(),ReferenceLocationList:[i()],Rename:function(e){a.Name=e,a.RenameList.forEach((t=>{t(e)}))}};return t.VariableList.push(a),a}function u(e,t){r(e,"Missing var name");let o=function(e){for(const t of n)if(t.Name==e)return t;let t={Type:"Global",Name:e,RenameList:[],AssignedTo:!1,Scope:null,BeginLocation:i(),EndLocation:i(),ReferenceLocationList:[],Rename:function(e){t.Name=e,t.RenameList.forEach((t=>{t(e)}))}};return n.push(t),t}(e);return o.RenameList.push(t),o}function T(e,t){let n;for(n=e.VariableList.length-1;n>=0;n--)if(e.VariableList[n].Name==t)return e.VariableList[n];if(e.ParentScope){let n=T(e.ParentScope,t);if(n)return n}}function p(e,n){r(e,"Missing var name");let o=T(t,e);o?o.RenameList.push(n):o=u(e,n);let a=i();return o.EndLocation=a,o.ReferenceLocationList.push(o.EndLocation),o}a();let c={};return c.FunctionLiteral={Pre:function(e){a(),e.ArgList.forEach(((e,t)=>{let n=s(e.Source,(function(t,n){n||(e.Source=t)}),{Type:"Argument",Index:t});e.var=n}))},Post:function(e){l()}},c.VariableExpr=function(e){e.Variable=p(e.Token.Source,(function(t){e.Token.Source=t}))},c.StatList={Pre:function(e){a()},Post:function(e){e.SkipPop||l()}},c.LocalVarStat={Post:function(e){e.VarList.forEach(((t,n)=>{s(t.Source,(function(t){e.VarList[n].Source=t}),{Type:"Local"})}))}},c.LocalFunctionStat={Pre:function(e){s(e.FunctionStat.NameChain[0].Source,(function(t){e.FunctionStat.NameChain[0].Source=t}),{Type:"LocalFunction"}),a(),e.FunctionStat.ArgList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"Argument",Index:t})}))},Post:function(){l()}},c.FunctionStat={Pre:function(e){let n,o=e.NameChain;n=1==o.length?T(t,o[0].Source)?p(o[0].Source,(function(e){o[0].Source=e})):u(o[0].Source,(function(e){o[0].Source=e})):p(o[0].Source,(function(e){o[0].Source=e})),n.AssignedTo=!0,a(),e.ArgList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"Argument",Index:t})}))},Post:function(){l()}},c.GenericForStat={Pre:function(e){return e.GeneratorList.forEach((e=>{g(e,c)})),a(),e.VarList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"ForRange",Index:t})})),g(e.Body,c),l(),!0}},c.NumericForStat={Pre:function(e){return e.RangeList.forEach((e=>{g(e,c)})),a(),e.VarList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"ForRange",Index:t})})),g(e.Body,c),l(),!0}},c.RepeatStat={Pre:function(e){e.Body.SkipPop=!0},Post:function(e){l()}},c.AssignmentStat={Post:function(e){e.Lhs.forEach((e=>{null!=e.Variable&&(e.Variable.AssignedTo=!0)}))}},g(e,c),[n,l()]}function F(e){let t,n,o="";function i(e){if(null==e.LeadingWhite||null==e.Source)throw`Bad token: tk=${e} | lwhite=${e.LeadingWhite} | source=${e.Source}`;o=`${o}${e.LeadingWhite}${e.Source}`}return n=function(e){if("BinopExpr"==e.Type)n(e.Lhs),i(e.Token_Op),n(e.Rhs);else if("UnopExpr"==e.Type)i(e.Token_Op),n(e.Rhs);else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type)i(e.Token);else if("FieldExpr"==e.Type)n(e.Base),i(e.Token_Dot),i(e.Field);else if("IndexExpr"==e.Type)n(e.Base),i(e.Token_OpenBracket),n(e.Index),i(e.Token_CloseBracket);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)n(e.Base),"MethodExpr"==e.Type&&(i(e.Token_Colon),i(e.Method)),"StringCall"==e.FunctionArguments.CallType?i(e.FunctionArguments.Token):"ArgCall"==e.FunctionArguments.CallType?(i(e.FunctionArguments.Token_OpenParen),e.FunctionArguments.ArgList.forEach(((t,o)=>{n(t);let r=e.FunctionArguments.Token_CommaList[o];null!=r&&i(r)})),i(e.FunctionArguments.Token_CloseParen)):"TableCall"==e.FunctionArguments.CallType&&n(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)i(e.Token_Function),i(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{i(t);let o=e.Token_ArgCommaList[n];null!=o&&i(o)})),null!=e.Token_Varg&&i(e.Token_Varg),i(e.Token_CloseParen),t(e.Body),i(e.Token_End);else if("VariableExpr"==e.Type)i(e.Token);else if("ParenExpr"==e.Type)i(e.Token_OpenParen),n(e.Expression),i(e.Token_CloseParen);else if("TableLiteral"==e.Type)i(e.Token_OpenBrace),e.EntryList.forEach(((t,o)=>{if("Field"==t.EntryType)i(t.Field),i(t.Token_Equals),n(t.Value);else if("Index"==t.EntryType)i(t.Token_OpenBracket),n(t.Index),i(t.Token_CloseBracket),i(t.Token_Equals),n(t.Value);else{if("Value"!=t.EntryType)throw"unreachable";n(t.Value)}let r=e.Token_SeperatorList[o];null!=r&&i(r)})),i(e.Token_CloseBrace);else{if("CompoundStat"!=e.Type)throw`unreachable, type: ${e.Type}: ${e}`;t(e)}},t=function(e){if(null==e)throw`STAT IS NIL! ${e}`;if("StatList"!==e.Type||0!==e.StatementList.length){if(e.WrapInDo){let t=(a=e.GetFirstToken(),"string"!=typeof a?.LeadingWhite?" ":a.LeadingWhite);e.GetFirstToken().LeadingWhite="",o+=`${t}do `}var a;"StatList"==e.Type?e.StatementList.forEach(((n,o)=>{null!==n&&null!==n.Type&&(n.Remove=()=>{e.StatementList[o]=null},t(n),e.SemicolonList[o]&&i(e.SemicolonList[o]))})):"BreakStat"==e.Type?i(e.Token_Break):"ContinueStat"==e.Type?i(e.Token_Continue):"GotoStat"==e.Type?(i(e.Token_Goto),i(e.Token_Label)):"LabelStat"==e.Type?(i(e.Token_ColonsLeft),i(e.Token_Label),i(e.Token_ColonsRight)):"ReturnStat"==e.Type?(i(e.Token_Return),e.ExprList.forEach(((t,o)=>{n(t),e.Token_CommaList[o]&&i(e.Token_CommaList[o])}))):"LocalVarStat"==e.Type?(i(e.Token_Local),e.VarList.forEach(((t,n)=>{i(t),null!=t.Attribute&&i(t.Attribute);let o=e.Token_VarCommaList[n];null!=o&&i(o)})),null!=e.Token_Equals&&(i(e.Token_Equals),e.ExprList.forEach(((t,o)=>{n(t);let r=e.Token_ExprCommaList[o];null!=r&&i(r)})))):"LocalFunctionStat"==e.Type?(i(e.Token_Local),i(e.FunctionStat.Token_Function),i(e.FunctionStat.NameChain[0]),i(e.FunctionStat.Token_OpenParen),e.FunctionStat.ArgList.forEach(((t,n)=>{i(t);let o=e.FunctionStat.Token_ArgCommaList[n];null!=o&&i(o)})),e.FunctionStat.Token_Varg&&i(e.FunctionStat.Token_Varg),i(e.FunctionStat.Token_CloseParen),t(e.FunctionStat.Body),i(e.FunctionStat.Token_End)):"FunctionStat"==e.Type?(i(e.Token_Function),e.NameChain.forEach(((t,n)=>{i(t);let o=e.Token_NameChainSeperator[n];null!=o&&i(o)})),i(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{i(t);let o=e.Token_ArgCommaList[n];null!=o&&i(o)})),e.Token_Varg&&i(e.Token_Varg),i(e.Token_CloseParen),t(e.Body),i(e.Token_End)):"RepeatStat"==e.Type?(i(e.Token_Repeat),t(e.Body),i(e.Token_Until),n(e.Condition)):"GenericForStat"==e.Type?(i(e.Token_For),e.VarList.forEach(((t,n)=>{i(t);let o=e.Token_VarCommaList[n];null!=o&&i(o)})),i(e.Token_In),e.GeneratorList.forEach(((t,o)=>{n(t);let r=e.Token_GeneratorCommaList[o];null!=r&&i(r)})),i(e.Token_Do),t(e.Body),i(e.Token_End)):"NumericForStat"==e.Type?(i(e.Token_For),e.VarList.forEach(((t,n)=>{i(t);let o=e.Token_VarCommaList[n];null!=o&&i(o)})),i(e.Token_Equals),e.RangeList.forEach(((t,o)=>{n(t);let r=e.Token_RangeCommaList[o];null!=r&&i(r)})),i(e.Token_Do),t(e.Body),i(e.Token_End)):"WhileStat"==e.Type?(i(e.Token_While),n(e.Condition),i(e.Token_Do),t(e.Body),i(e.Token_End)):"DoStat"==e.Type?(i(e.Token_Do),t(e.Body),i(e.Token_End)):"IfStat"==e.Type?(i(e.Token_If),n(e.Condition),i(e.Token_Then),t(e.Body),e.ElseClauseList.forEach((e=>{i(e.Token),null!=e.Condition&&(n(e.Condition),i(e.Token_Then)),t(e.Body)})),i(e.Token_End)):"CallExprStat"==e.Type?n(e.Expression):"CompoundStat"==e.Type?(n(e.Lhs),i(e.Token_Compound),n(e.Rhs),e.Type="CompoundStat"):"AssignmentStat"==e.Type?(e.Lhs.forEach(((t,o)=>{n(t);let r=e.Token_LhsSeperatorList[o];null!=r&&i(r)})),i(e.Token_Equals),e.Rhs.forEach(((t,o)=>{n(t);let r=e.Token_RhsSeperatorList[o];null!=r&&i(r)}))):r(!1,"unreachable"),e.WrapInDo&&(o+=" end ")}},t(e),o}function b(e){let t,n;function o(e){e&&(e.LeadingWhite="")}function i(e,t,n=!1){o(t);let r=("string"==typeof e.Source?e.Source:e.Source.toString()).substr(e.Source.length-1,1),i=("string"==typeof t.Source?t.Source:t.Source.toString()).substr(0,1);"-"==r&&"-"==i||u.includes(r)&&u.includes(i)||n&&")"==r&&"("==i?t.LeadingWhite=n?";":" ":t.LeadingWhite=""}function a(e,n,r){t(n),o(r);let a=n.GetFirstToken(),l=n.GetLastToken();null!=a?(i(e,a),i(l,r)):i(e,r)}n=function(e){if("BinopExpr"===e.Type)n(e.Lhs),n(e.Rhs),"NumberLiteral"==e.Lhs.Type&&".."==e.Token_Op.Source?e.Token_Op.LeadingWhite=" ":(o(e.Token_Op),i(e.Lhs.GetLastToken(),e.Token_Op)),i(e.Token_Op,e.Rhs.GetFirstToken());else if("UnopExpr"===e.Type)o(e.Token_Op),n(e.Rhs),i(e.Token_Op,e.Rhs.GetFirstToken());else if("NumberLiteral"===e.Type||"StringLiteral"===e.Type||"NilLiteral"===e.Type||"BooleanLiteral"===e.Type||"VargLiteral"===e.Type||"HashLiteral"===e.Type)o(e.Token);else if("FieldExpr"==e.Type)n(e.Base),o(e.Token_Dot),o(e.Field);else if("IndexExpr"==e.Type)n(e.Base),o(e.Token_OpenBracket),n(e.Index),o(e.Token_CloseBracket);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)n(e.Base),"MethodExpr"==e.Type&&(o(e.Token_Colon),o(e.Method)),"StringCall"==e.FunctionArguments.CallType?o(e.FunctionArguments.Token):"ArgCall"==e.FunctionArguments.CallType?(o(e.FunctionArguments.Token_OpenParen),e.FunctionArguments.ArgList.forEach(((t,r)=>{n(t);let i=e.FunctionArguments.Token_CommaList[r];null!=i&&o(i)})),o(e.FunctionArguments.Token_CloseParen)):"TableCall"==e.FunctionArguments.CallType&&n(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)o(e.Token_Function),o(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{o(t);let r=e.Token_ArgCommaList[n];null!=r&&o(r)})),null!=e.Token_Varg&&o(e.Token_Varg),o(e.Token_CloseParen),a(e.Token_CloseParen,e.Body,e.Token_End);else if("VariableExpr"==e.Type)o(e.Token);else if("ParenExpr"==e.Type)o(e.Token_OpenParen),n(e.Expression),o(e.Token_CloseParen);else{if("TableLiteral"!=e.Type)throw`unreachable, type: ${e.Type}:${e}  ${console.trace()}`;o(e.Token_OpenBrace),e.EntryList.forEach(((t,i)=>{"Field"==t.EntryType?(o(t.Field),o(t.Token_Equals),n(t.Value)):"Index"==t.EntryType?(o(t.Token_OpenBracket),n(t.Index),o(t.Token_CloseBracket),o(t.Token_Equals),n(t.Value)):"Value"==t.EntryType?n(t.Value):r(!1,"unreachable");let a=e.Token_SeperatorList[i];null!=a&&o(a)})),e.Token_SeperatorList[e.EntryList.length-1]=null,o(e.Token_CloseBrace)}},t=function(e){if("StatList"==e.Type){let n;for(n=0;n<=e.StatementList.length;n++){let r=e.StatementList[n];if(null==r)continue;t(r),o(r.GetFirstToken());let a=e.StatementList[n-1];if(null!=a){let t={")":["(","["],"]":["(","["]};if(e.SemicolonList[n-1]){let o=a.GetLastToken().Source,i=r.GetFirstToken().Source;null!==t[o]&&void 0!==t[o]&&t[o].includes(i)||(e.SemicolonList[n-1]=null)}e.SemicolonList[n-1]||i(a.GetLastToken(),r.GetFirstToken(),!0)}}e.SemicolonList[e.StatementList.length-1]=null,e.StatementList.length>0&&o(e.StatementList[0].GetFirstToken())}else if("BreakStat"==e.Type)o(e.Token_Break);else if("ContinueStat"==e.Type)o(e.Token_Continue);else if("GotoStat"==e.Type)o(e.Token_Goto),i(e.Token_Goto,e.Token_Label);else if("LabelStat"==e.Type)o(e.Token_ColonsLeft),o(e.Token_Label),o(e.Token_ColonsRight);else if("ReturnStat"==e.Type)o(e.Token_Return),e.ExprList.forEach(((t,r)=>{n(t),null!=e.Token_CommaList[r]&&o(e.Token_CommaList[r])})),e.ExprList.length>0&&i(e.Token_Return,e.ExprList[0].GetFirstToken());else if("LocalVarStat"==e.Type){o(e.Token_Local);let t=!1;e.VarList.forEach(((n,r)=>{0==r?i(e.Token_Local,n):o(n),n.Attribute&&(o(n.Attribute),r+1==e.VarList.length&&(t=!0));let a=e.Token_VarCommaList[r];null!=a&&o(a)})),null!=e.Token_Equals&&(t||o(e.Token_Equals),e.ExprList.forEach(((t,r)=>{n(t);let i=e.Token_ExprCommaList[r];null!=i&&o(i)})))}else if("LocalFunctionStat"==e.Type)o(e.Token_Local),i(e.Token_Local,e.FunctionStat.Token_Function),i(e.FunctionStat.Token_Function,e.FunctionStat.NameChain[0]),i(e.FunctionStat.NameChain[0],e.FunctionStat.Token_OpenParen),e.FunctionStat.ArgList.forEach(((t,n)=>{o(t);let r=e.FunctionStat.Token_ArgCommaList[n];null!=r&&o(r)})),e.FunctionStat.Token_Varg&&o(e.FunctionStat.Token_Varg),o(e.FunctionStat.Token_CloseParen),a(e.FunctionStat.Token_CloseParen,e.FunctionStat.Body,e.FunctionStat.Token_End);else if("FunctionStat"==e.Type)o(e.Token_Function),e.NameChain.forEach(((t,n)=>{0==n?i(e.Token_Function,t):o(t);let r=e.Token_NameChainSeperator[n];null!=r&&o(r)})),o(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{o(t);let r=e.Token_ArgCommaList[n];null!=r&&o(r)})),e.Token_Varg&&o(e.Token_Varg),o(e.Token_CloseParen),a(e.Token_CloseParen,e.Body,e.Token_End);else if("RepeatStat"==e.Type)o(e.Token_Repeat),a(e.Token_Repeat,e.Body,e.Token_Until),n(e.Condition),i(e.Token_Until,e.Condition.GetFirstToken());else if("GenericForStat"==e.Type)o(e.Token_For),e.VarList.forEach(((t,n)=>{0==n?i(e.Token_For,t):o(t);let r=e.Token_VarCommaList[n];null!=r&&o(r)})),i(e.VarList[e.VarList.length-1],e.Token_In),e.GeneratorList.forEach(((t,r)=>{n(t),0==r&&i(e.Token_In,t.GetFirstToken());let a=e.Token_GeneratorCommaList[r];null!=a&&o(a)})),i(e.GeneratorList[e.GeneratorList.length-1].GetLastToken(),e.Token_Do),a(e.Token_Do,e.Body,e.Token_End);else if("NumericForStat"==e.Type)o(e.Token_For),e.VarList.forEach(((t,n)=>{0==n?i(e.Token_For,t):o(t);let r=e.Token_VarCommaList[n];null!=r&&o(r)})),i(e.VarList[e.VarList.length-1],e.Token_Equals),e.RangeList.forEach(((t,r)=>{n(t),0==r&&i(e.Token_Equals,t.GetFirstToken());let a=e.Token_RangeCommaList[r];null!=a&&o(a)})),i(e.RangeList[e.RangeList.length-1].GetLastToken(),e.Token_Do),a(e.Token_Do,e.Body,e.Token_End);else if("WhileStat"==e.Type)o(e.Token_While),n(e.Condition),o(e.Token_Do),i(e.Token_While,e.Condition.GetFirstToken()),i(e.Condition.GetLastToken(),e.Token_Do),a(e.Token_Do,e.Body,e.Token_End);else if("DoStat"==e.Type)o(e.Token_Do),o(e.Token_End),a(e.Token_Do,e.Body,e.Token_End);else if("IfStat"==e.Type){o(e.Token_If),n(e.Condition),i(e.Token_If,e.Condition.GetFirstToken()),i(e.Condition.GetLastToken(),e.Token_Then);let r=e.Token_Then,l=e.Body;e.ElseClauseList.forEach(((e,o)=>{a(r,l,e.Token),r=e.Token,null!=e.Condition&&(n(e.Condition),i(e.Token,e.Condition.GetFirstToken()),i(e.Condition.GetLastToken(),e.Token_Then),r=e.Token_Then),t(e.Body),l=e.Body})),a(r,l,e.Token_End)}else if("CallExprStat"==e.Type)n(e.Expression);else if("CompoundStat"==e.Type)n(e.Lhs),o(e.Token_Compound),n(e.Rhs),i(e.Lhs.GetLastToken(),e.Token_Compound),i(e.Token_Compound,e.Rhs.GetFirstToken());else{if("AssignmentStat"!=e.Type)return n(e);e.Lhs.forEach(((t,r)=>{n(t);let i=e.Token_LhsSeperatorList[r];null!=i&&o(i)})),o(e.Token_Equals),e.Rhs.forEach(((t,r)=>{n(t);let i=e.Token_RhsSeperatorList[r];null!=i&&o(i)}))}},t(e)}function x(e){let t,n,o={NumberLiteral:!0,BooleanLiteral:!0,StringLiteral:!0,HashLiteral:!0,NilLiteral:!0,TableLiteral:!0,ParenExpr:!0,BinopExpr:!0};function a(e,t,n=null){let o;return o={Type:e,Token:{Type:null==n?"Number":n,LeadingWhite:"",Source:t},GetFirstToken:()=>o.Token,GetLastToken:()=>o.Token},o}function l(e,t){let n;return n={Type:"UnopExpr",Token_Op:{Type:"Symbol",LeadingWhite:"",Source:e},Rhs:t,GetFirstToken:()=>n.Token_Op,GetLastToken:()=>n.Rhs.GetLastToken()},n}function s(e,t){if(null!=t)for(var[n,o]of Object.entries(t))e[n]=o}function u(e){if(null==e||null==e.substr)return;let t,n=e.substr(0,1);if('"'!=n&&"'"!=n||(t=e.substr(1,e.length-2)),"["==n){let n=0,o=1;for(;"="==e.substr(o,1);)n++,o++;t=e.substr(2+n,e.length-4-n-2)}if(null==t)return"";let o,r="";for(o=0;o<=t.length;o++){let e=t.substr(o,1);r+="'"==e||'"'==e?`\\${e}`:e}return r}function T(e){if("object"==typeof e&&"ParenExpr"==e.Type)return s(e,e.Expression)}n=function(e){if("BinopExpr"==e.Type){if(n(e.Lhs),n(e.Rhs),null!=e.Lhs&&null!=e.Rhs){let t=e.Token_Op;if(null!=t&&null!=t.Source){let n=function(e,t,n){let o=t,r=n;if(t&&"ParenExpr"==t.Type&&(o=t.Expression),n&&"ParenExpr"==n.Type&&(r=n.Expression),null==o||null==r||null==o.Type||null==r.Type)return;if("VariableExpr"==o.Type||"CallExpr"==o.Type||"BinopExpr"==o.Type||"CallExpr"==r.Type||"BinopExpr"==r.Type||"VariableExpr"==r.Type)return;let a,l,s=o.Token||null!=o.Expression&&o.Expression.Token||null,T=r.Token||null!=r.Expression&&r.Expression.Token||null,p=null!=s?s.Source:null,c=null!=T?T.Source:null;if("BooleanLiteral"==o.Type&&(a="true"==p),"BooleanLiteral"==r.Type&&(l="true"==c),!("NumberLiteral"==o.Type&&(a=i(p),null==a)||"NumberLiteral"==r.Type&&(l=i(c),null==l)||("StringLiteral"!=o.Type&&"HashLiteral"!=o.Type||(a=p.toString()),"StringLiteral"!=r.Type&&"HashLiteral"!=r.Type||(l=c.toString()),null==a||null==l))){if("=="==e)return a==l;if("~="==e)return a!=l;if("and"==e)return a&&l;if("or"==e)return a||l;if(".."==e&&"StringLiteral"==o.Type&&"StringLiteral"==r.Type)return`"${u(p)+u(c)}"`;if("StringLiteral"==o.Type&&(a=i(u(a))),"StringLiteral"==r.Type&&(l=i(u(l))),null==a||null==l)return;let t;if("+"==e&&(t=a+l),"-"==e&&(t=a-l),"*"==e&&(t=a*l),"/"==e&&(t=a/l),"^"==e&&(t=a**l),"%"==e&&(t=a%l),">"==e&&(t=a>l),"<"==e&&(t=a<l),">="==e&&(t=a>=l),"<="==e&&(t=a<=l),0==t||1==t||isFinite(t)&&t>-1e6&&t<10**6)return t}}(t.Source,e.Lhs,e.Rhs);if(null!=n){if("boolean"==typeof n){let t=a("BooleanLiteral",n.toString(),"Keyword");return void s(e,t)}if("number"==typeof n){if(1==isFinite(n)){let t=a("NumberLiteral",n.toString(),"Number");return void s(e,t)}}else{if("string"==typeof n){let t=a("StringLiteral",n,"String");return void s(e,t)}if("object"==typeof n)return void s(e,n)}return}}if("ParenExpr"==e.Lhs.Type){let t=e.Lhs.Expression;"NumberLiteral"==t.Type||"StringLiteral"==t.Type||"NilLiteral"==t.Type||"BooleanLiteral"==t.Type||t.Type}if("ParenExpr"==e.Rhs.Type){let t=e.Rhs.Expression;"NumberLiteral"==t.Type||"StringLiteral"==t.Type||"NilLiteral"==t.Type||"BooleanLiteral"==t.Type||t.Type}}}else if("UnopExpr"==e.Type){if(n(e.Rhs),null!=e.Rhs&&1==o[e.Rhs.Type]){let t=e.Token_Op;if(null!=t&&null!=t.Source){let n=null!=e.Rhs.Expression?e.Rhs.Expression:e.Rhs,o=function(e,t){let n=t.Token||t.Expression||t.EntryList||t;if(null==n)return;if(null==n.Source&&"TableLiteral"!=t.Type)return;if("VariableExpr"==t.Type||"CallExpr"==t.Type||"BinopExpr"==t.Type)return;let o,r=n.Source;if("TableLiteral"==t.Type&&null!=n){let o=[],r=0,i=!1,s=!1,u=0;if(n.forEach(((e,t)=>{if(i)o.push(e);else if("Value"==e.EntryType||"Index"==e.EntryType)if(null!=e.Index&&"NumberLiteral"!=e.Index.Type||!e.Value)o.push(e);else{if((null!=e.Index&&null!=e.Index.Token&&null!==e.Index.Token.Source?e.Index.Token.Source:u+1).toString()!==(++u).toString())return i=!0,s=!0,o.push(e);"CallExpr"!=e.Value.Type?r++:(i=!0,o.push(e))}})),s)return;if("#"==e){if(t.EntryList=o,t.EntryList.length<=0)return a("NumberLiteral",null!==r?r:t.EntryList.length);if(r<=0)return l("#",t);let e=function(e,t,n){let o;return o={Type:"BinopExpr",Token_Op:{Type:"Symbol",LeadingWhite:"",Source:"+"},Lhs:t,Rhs:n,GetFirstToken:()=>o.Lhs.GetFirstToken(),GetLastToken:()=>o.Rhs.GetLastToken()},o}(0,a("NumberLiteral",r),l("#",t));return e}}if("BooleanLiteral"==t.Type&&(o="true"==r),"NumberLiteral"!=t.Type||(o=i(r),null!==o)){if("StringLiteral"==t.Type&&(o=r.substr(1,r.length-2)),"not"==e&&null!==t.Type)return"NilLiteral"==t.Type||"BooleanLiteral"==t.Type&&!1===o;if(null!=o){if("#"==e)return o.length;if("-"==e)return-o}}}(t.Source,n);if(null!=o){if("boolean"==typeof o){let t=a("BooleanLiteral",o.toString(),"Keyword");return void s(e,t)}if("number"==typeof o){if(1==isFinite(o)){let t=a("NumberLiteral",o,"Number");return void s(e,t)}}else{if("string"==typeof o){let t=a("StringLiteral",o,"String");return void s(e,t)}if("object"==typeof o)return void s(e,o)}return}}}}else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type){let t=e.Token;if(null!=t){if("Number"==t.Type){let e=t.Source.toString().split("e");if(2===e.length){let n=i(e[0]),o=i(e[1]);isFinite(n)&&isFinite(o)&&n**o<999999999&&!t.Source.includes("+")&&t.Source.includes(".")&&!t.Source.includes("-")&&(t.Source=(n**o).toString())}}"String"==t.Type&&(t.Source=t.Source.replace(/\\\d+/gi,(e=>{let t=i(e.substr(1,e.length-1));return t&&isFinite(t)&&(t>=97&&t<=122||t>=65&&t<=90||t>=33&&t<=47||t>=58&&t<=64||t>=91&&t<=96||t>=123&&t<=126)&&34!==t&&39!==t&&92!==t?String.fromCharCode(t):e})))}}else if("FieldExpr"==e.Type)n(e.Base);else if("IndexExpr"==e.Type)n(e.Base),n(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type){if(n(e.Base),"ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach(((e,t)=>{n(e)})):"TableCall"==e.FunctionArguments.CallType&&n(e.FunctionArguments.TableExpr),"ParenExpr"===e.Base.Type&&"FunctionLiteral"===e.Base.Expression.Type&&"ArgCall"===e.FunctionArguments.CallType){let t=e.Base.Expression;e.FunctionArguments.ArgList.forEach(((n,o)=>{let r=e.FunctionArguments.ArgList[o];if(void 0!==r&&("NumberLiteral"==r.Type||"StringLiteral"==r.Type||"NilLiteral"==r.Type||"BooleanLiteral"==r.Type||"HashLiteral"==r.Type)){let e=t.ArgList[o];e&&e.var.RenameList.forEach((e=>{e(r.Token.Source,!0)}))}}))}}else if("FunctionLiteral"==e.Type)t(e.Body);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type){let t=e.Expression;null!=t&&"ParenExpr"==t.Type&&(e.Expression=t.Expression),n(e.Expression),"NumberLiteral"!=e.Type&&"StringLiteral"!=e.Type&&"NilLiteral"!=e.Type&&"BooleanLiteral"!=e.Type&&"VargLiteral"!=e.Type&&"HashLiteral"!=e.Type||T(e)}else"TableLiteral"==e.Type&&e.EntryList.forEach(((e,t)=>{"Field"==e.EntryType?n(e.Value):"Index"==e.EntryType?(n(e.Index),n(e.Value)):"Value"==e.EntryType?n(e.Value):r(!1,"unreachable")}))},t=function(e){if("StatList"==e.Type)e.StatementList.forEach(((n,o)=>{null!==n&&null!==n.Type&&(n.Remove=()=>{e.StatementList[o]=null},t(n))}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach(((e,t)=>{n(e)}));else if("LocalVarStat"==e.Type)null!=e.Token_Equals&&e.ExprList.forEach(((e,t)=>{n(e)}));else if("LocalFunctionStat"==e.Type)t(e.FunctionStat.Body),1===e.FunctionStat.NameChain.length&&e.FunctionStat.NameChain[0].UseCount;else if("FunctionStat"==e.Type)t(e.Body);else if("RepeatStat"==e.Type)t(e.Body),n(e.Condition),"StatList"==e.Body.Type&&e.Body.StatementList.length;else if("GenericForStat"==e.Type)e.GeneratorList.forEach(((e,t)=>{n(e)})),t(e.Body);else if("NumericForStat"==e.Type){e.RangeList.forEach(((e,t)=>{n(e)})),t(e.Body);let o=e.RangeList[0],r=e.RangeList[1],a=e.RangeList[2];if(null==o||null==r)return e.Remove();if(T(o),T(r),T(a),"NumberLiteral"!=o.Type||"NumberLiteral"!=r.Type||null!=a&&"NumberLiteral"!=a.Type||null==a)return;let l=i(o.Token.Source),s=i(r.Token.Source),u=null!=a&&i(a.Token.Source)||1;if(!((u>0&&l<=s||u<0&&l>=s)&&(s-l+u)/u>=0))return e.Remove();if("StatList"==e.Body.Type&&0===e.Body.StatementList.length)return e.Remove()}else if("WhileStat"==e.Type){n(e.Condition),t(e.Body);let o=e.Condition;switch(o.Type){case"ParenExpr":o=o.Expression;case"BooleanLiteral":if(null==o||null==o.Token||"false"!==o.Token.Source)break;case"NilLiteral":e.Remove()}}else if("DoStat"==e.Type){if(t(e.Body),null===e.Body||"StatList"==e.Body.Type&&0===e.Body.StatementList.length)return e.Remove();if(1===e.Body.StatementList.length){let t=e.Body.StatementList[0];"ContinueStat"!==t.Type&&"BreakStat"!==t.Type&&"ReturnStat"!==t.Type&&s(e,t)}}else if("IfStat"==e.Type){n(e.Condition),t(e.Body),e.ElseClauseList.forEach(((e,o)=>{null!=e.Condition&&n(e.Condition),t(e.Body)}));let o=e.Condition;switch(o.Type){case"ParenExpr":o=o.Expression;case"BooleanLiteral":if(e.ElseClauseList.length>=1||null==o||null==o.Token||"false"!==o.Token.Source)break;case"NilLiteral":e.Remove()}}else"CallExprStat"==e.Type?n(e.Expression):"CompoundStat"==e.Type?(n(e.Lhs),n(e.Rhs)):"AssignmentStat"==e.Type&&(e.Lhs.forEach(((e,t)=>{n(e)})),e.Rhs.forEach(((e,t)=>{n(e)})))},t(e)}let B,G=[];for(B="a".charCodeAt();B<="z".charCodeAt();B++)G.push(String.fromCharCode(B));for(B="A".charCodeAt();B<="Z".charCodeAt();B++)G.push(String.fromCharCode(B));for(B="0".charCodeAt();B<="9".charCodeAt();B++)G.push(String.fromCharCode(B));G.push("_");let R=[];for(B="a".charCodeAt();B<="z".charCodeAt();B++)R.push(String.fromCharCode(B));for(B="A".charCodeAt();B<="Z".charCodeAt();B++)R.push(String.fromCharCode(B));function V(e){let t="",n=e%R.length;for(e=(e-n)/R.length,t=`${t}${R[n]}`;e>0;){let n=e%G.length;e=(e-n)/G.length,t=`${t}${G[n]}`}return t}let A={Minify:function(e,t){let n=_(e),[o,r]=C(n);1==t.RenameVariables&&function(e,t,n){let o=[];for(var[r,i]of Object.entries(h))o[r]=!0;let a=[],l=[];e.forEach((e=>{e.AssignedTo&&n?a.push(e):o[e.Name]=!0})),function e(t){t.VariableList.forEach((e=>{a.push(e),l.push(e)})),t.ChildScopeList.forEach((t=>{e(t)}))}(t),a.forEach((e=>{e.UsedNameArray=[]})),a.sort(((e,t)=>e-t));let s=0,u=[];a.forEach(((e,t)=>{e.Renamed=!0;let n=0;for(;e.UsedNameArray[n];)n++;e.Rename(function(e){let t=u[e];if(null==t){for(t=V(s),s++;o[t];)t=V(s),s++;u[e]=t}return t}(n)),e.Scope?a.forEach((t=>{t.Renamed||(!t.Scope||t.Scope.Depth<e.Scope.Depth?t.ReferenceLocationList.some((o=>o>=e.BeginLocation&&o<=e.ScopeEndLocation&&(t.UsedNameArray[n]=!0,!0))):t.Scope.Depth>e.Scope.Depth?e.ReferenceLocationList.some((e=>e>=t.BeginLocation&&e<=t.ScopeEndLocation&&(t.UsedNameArray[n]=!0,!0))):e.BeginLocation<t.EndLocation&&e.EndLocation>t.BeginLocation&&(t.UsedNameArray[n]=!0))})):a.forEach((t=>{if(!t.Renamed)if("Global"==t.Type)t.UsedNameArray[n]=!0;else{if("Local"!=t.Type)throw"Unreachable";e.ReferenceLocationList.some((e=>e>=t.BeginLocation&&e<=t.ScopeEndLocation&&(t.UsedNameArray[n]=!0,!0)))}}))}))}(o,r,t.RenameGlobals),1==t.SolveMath&&x(n),b(n);let i=F(n);return i=`\n\n${i}`,i},Beautify:function(e,t){let n=_(e),[i,l]=C(n);t.RenameVariables&&function(e,t,n){let o=[];e.forEach((e=>{e.AssignedTo&&n||(o[e.Name]=!0)}));let r=1,i=1;function a(e,t){e.Name=t,e.RenameList.forEach((e=>{e(t)}))}if(n){let t={};e.forEach((e=>{e.AssignedTo&&!e.ChangedName&&(t[e.Name]=t[e.Name]||`G_${i}_`,e.ChangedName=!0,a(e,t[e.Name]),i++)}))}!function e(t){t.VariableList.forEach((e=>{let t=`L_${r}_`;"Argument"==e.Info.Type?t=`${t}arg${e.Info.Index}`:"LocalFunction"==e.Info.Type?t=`${t}func`:"ForRange"==e.Info.Type&&(t=`${t}forvar${e.Info.Index}`),a(e,t),r++})),t.ChildScopeList.forEach((t=>{e(t)}))}(t)}(i,l,t.RenameGlobals),1==t.SolveMath&&x(n),function(e){let t,n,i=0;function l(e){if(void 0===e)return;let t=`\n${"\t".repeat(i)}`;if(""==e.LeadingWhite||e.LeadingWhite.substr(-t.length,t.length)!=t){let n,o="";for(n=e.LeadingWhite.length;n>=0;n--){let t=e.LeadingWhite.substr(n,1);if(""!=t&&!t.match(/\s/g)){o=e.LeadingWhite.substr(0,n+1);break}}e.LeadingWhite=`${o}${t}`}}function s(){i++}function u(){i--,r(i>=0,"Undented too far")}function T(e){e.LeadingWhite=e.LeadingWhite.trim()}function p(e){T(e),a.includes(function(e){return e.LeadingWhite.length>0?e.LeadingWhite.substr(0,1):e.Source.toString().substr(0,1)}(e))||(e.LeadingWhite=" "+e.LeadingWhite)}function c(e){p(e.GetFirstToken())}function f(e,n,o){s(),t(n),u(),l(o)}n=function(e){if("BinopExpr"==e.Type)n(e.Lhs),n(e.Rhs),c(e.Rhs),p(e.Token_Op);else if("UnopExpr"==e.Type)T(e.Token_Op),n(e.Rhs),e.Token_Op.Source[0]&&p(e.Rhs.GetFirstToken());else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type)T(e.Token),"HashLiteral"==e.Type&&(e.Token.Source='"'+function(e){for(var t=0,n=e.length;n--;)t+=e.charCodeAt(n),t+=t<<10,t^=t>>6;return t+=t<<3,(t^=t>>11)+(t<<15)}(`${e.Token.Source.substring(1,e.Token.Source.length-1)}`)+'"',e.Type="StringLiteral",e.Token.Type="String");else if("FieldExpr"==e.Type)n(e.Base);else if("IndexExpr"==e.Type)n(e.Base),n(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)n(e.Base),T(e.FunctionArguments.GetFirstToken()),T(e.FunctionArguments.GetLastToken()),e.Type,"StringCall"==e.FunctionArguments.CallType||("ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach(((t,o)=>{n(t),o>0&&c(t);let r=e.FunctionArguments.Token_CommaList[o];null!=r&&T(r)})):"TableCall"==e.FunctionArguments.CallType&&n(e.FunctionArguments.TableExpr));else if("FunctionLiteral"==e.Type)e.ArgList.forEach(((t,n)=>{n>0&&p(t),e.Token_ArgCommaList[n]})),e.ArgList.length>0&&null!=e.Token_Varg&&p(e.Token_Varg),f(e.Token_CloseParen,e.Body,e.Token_End);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type)T(e.Token_OpenParen),T(e.Token_CloseParen),n(e.Expression);else if("TableLiteral"==e.Type)if(0==e.EntryList.length);else{s();let t=100;e.EntryList.forEach(((o,i)=>{"Field"==o.EntryType?(e.EntryList.length>t?b(o.Value):l(o.Field),p(o.Token_Equals),n(o.Value),c(o.Value)):"Index"==o.EntryType?(e.EntryList.length>t?T(o.Token_OpenBracket):l(o.Token_OpenBracket),n(o.Index),p(o.Token_Equals),n(o.Value),c(o.Value)):"Value"==o.EntryType?(n(o.Value),e.EntryList.length>t?b(o.Value):l(o.Value.GetFirstToken())):r(!1,"unreachable");let a=e.Token_SeperatorList[i];null!=a&&(e.EntryList.length>t?a.LeadingWhite="":T(a))})),u(),e.EntryList.length>t?e.Token_CloseBrace.LeadingWhite="":l(e.Token_CloseBrace)}else{if("CompoundStat"!=e.Type)throw o(e),`unreachable, type: ${e.Type}:`+e;t(e)}},t=function(e){if("StatList"==e.Type)e.StatementList.forEach(((e,n)=>{null!==e&&null!==e.Type&&("StatList"===e.Type&&0===e.StatementList.length||(e.Remove=()=>{e.StatementList[n]=null},t(e),l(e.GetFirstToken())))}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("GotoStat"==e.Type);else if("LabelStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach(((t,o)=>{n(t),c(t),e.Token_CommaList[o]}));else if("LocalVarStat"==e.Type){if(e.VarList.forEach(((t,n)=>{p(t),t.Attribute&&(t.Attribute.LeadingWhite=" "),e.Token_VarCommaList[n]})),e.Token_Equals){T(e.Token_Equals),p(e.Token_Equals);let t=[],o=[];e.ExprList.forEach(((n,r)=>{null!=n&&(r<e.VarList.length?(t.push(n),o.push(e.Token_ExprCommaList[r])):"CallExpr"!=n.Type&&"ParenExpr"!=n.Type&&"VargLiteral"!=n.Type&&"BinopExpr"!=n.Type&&"UnopExpr"!=n.Type||(t.push(n),o.push(e.Token_ExprCommaList[r])))})),e.ExprList=t,e.CommaList=o,e.ExprList.forEach(((t,o)=>{null!=t&&(n(t),c(t),null!=e.Token_ExprCommaList[o]&&e.ExprList.length-1==o&&(e.Token_ExprCommaList[o]=null))}))}}else if("LocalFunctionStat"==e.Type)p(e.FunctionStat.Token_Function),p(e.FunctionStat.NameChain[0]),e.FunctionStat.ArgList.forEach(((t,n)=>{n>0?p(t):T(t);let o=e.FunctionStat.Token_ArgCommaList[n];o&&T(o)})),e.FunctionStat.ArgList.length>0&&e.FunctionStat.Token_Varg?(T(e.FunctionStat.Token_Varg),p(e.FunctionStat.Token_Varg)):e.FunctionStat.Token_Varg&&T(e.FunctionStat.Token_Varg),T(e.FunctionStat.Token_OpenParen),T(e.FunctionStat.Token_CloseParen),f(e.FunctionStat.Token_CloseParen,e.FunctionStat.Body,e.FunctionStat.Token_End);else if("FunctionStat"==e.Type)e.NameChain.forEach(((t,n)=>{0==n&&p(t),e.Token_NameChainSeperator[n]})),e.ArgList.forEach(((t,n)=>{n>0&&p(t),e.Token_ArgCommaList[n]})),e.ArgList.length>0&&e.Token_Varg&&p(e.Token_Varg),f(e.Token_CloseParen,e.Body,e.Token_End);else if("RepeatStat"==e.Type)f(e.Token_Repeat,e.Body,e.Token_Until),n(e.Condition),c(e.Condition);else if("GenericForStat"==e.Type)e.VarList.forEach(((t,n)=>{p(t),e.Token_VarCommaList[n]})),p(e.Token_In),e.GeneratorList.forEach(((t,o)=>{n(t),c(t),e.Token_GeneratorCommaList[o]})),p(e.Token_Do),f(e.Token_Do,e.Body,e.Token_End);else if("NumericForStat"==e.Type)e.VarList.forEach(((t,n)=>{p(t),e.Token_VarCommaList[n]})),p(e.Token_Equals),e.RangeList.forEach(((t,o)=>{n(t),c(t),e.Token_RangeCommaList[o]})),p(e.Token_Do),f(e.Token_Do,e.Body,e.Token_End);else if("WhileStat"==e.Type)n(e.Condition),c(e.Condition),p(e.Token_Do),f(e.Token_Do,e.Body,e.Token_End);else if("DoStat"==e.Type)f(e.Token_Do,e.Body,e.Token_End);else if("IfStat"==e.Type){n(e.Condition),c(e.Condition),p(e.Token_Then);let t=e.Token_Then,o=e.Body;e.ElseClauseList.forEach((e=>{f(0,o,e.Token),t=e.Token,null!=e.Condition&&(n(e.Condition),c(e.Condition),p(e.Token_Then),t=e.Token_Then),o=e.Body})),f(0,o,e.Token_End)}else"CallExprStat"==e.Type?n(e.Expression):"CompoundStat"==e.Type?(n(e.Lhs),n(e.Rhs),c(e.Lhs),c(e.Rhs),p(e.Token_Compound)):"AssignmentStat"==e.Type?(e.Lhs.forEach(((t,o)=>{n(t),o>0&&c(t),e.Token_LhsSeperatorList[o]})),p(e.Token_Equals),e.Rhs.forEach(((t,o)=>{n(t),c(t),e.Token_RhsSeperatorList[o]}))):r(!1,"Unreachable")},t(e)}(n);let s=F(n);return s=`\n\n${s}`,s}};try{null!=e&&null!=e.exports&&(e.exports.Beautify=A.Beautify,e.exports.Minify=A.Minify)}catch(e){}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o](i,i.exports,n),i.loaded=!0,i.exports}return n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(987)})()));