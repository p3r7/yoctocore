<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>yoctocore</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="/static/tiny-brutalism.css">
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 1em;
    }


    .inactive {
      color: gray;
      background-color: #f0f0f0;
    }

    .fr {
      display: flex;
      justify-content: flex-end;
      text-align: right;
    }

    .center {
      display: flex;
      justify-content: center;
      text-align: center;
    }

    #app {
      width: 100%;
      max-width: 800px;
    }

    .active {
      font-weight: bold;
      /* add a shdwo to the top + left */
      box-shadow: -12px -12px 0 #000;

    }


    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    .output-details {
      margin-top: 20px;
    }

    .mode-manual {
      background-color: #fff;
      color: black;
    }

    .mode-midi-pitch {
      background-color: #ffd6a5;
      color: black;
    }

    .mode-midi-envelope {
      background-color: #fdffb6;
      color: black;
    }

    .mode-midi-cc {
      background-color: #caffbf;
      color: black;
    }

    .mode-midi-clock {
      background-color: #9bf6ff;
      color: black;
    }

    .mode-clock {
      background-color: #a0c4ff;
      color: black;
    }

    .mode-lfo {
      background-color: #bdb2ff;
      color: black;
    }

    #app {
      border: solid #000;
      background: #ff;
      padding: 2em;
      box-shadow: 8px 8px 0px #000000;
    }

    input:disabled,
    select:disabled {
      background-color: #f0f0f0;
      /* Light gray background */
      color: #a0a0a0;
      /* Dimmed text color */
      border: 1px solid #d0d0d0;
      /* Lighter border */
      cursor: not-allowed;
      /* Indicate the input is not clickable */
    }

    input:disabled:hover,
    select:disabled:hover {
      background-color: #f0f0f0;
      /* Prevent hover styles
      */
    }

    .grayed {
      color: #a0a0a0;
    }
  </style>
</head>

<body>
  <div id="app" class="app">
    <h1>yoctocore</h1>
    <h2>Control Panel</h2>
    <!-- check if device connected -->
    <div>
      <h3>MIDI routing</h3>
    </div>
    <div class="row" style="padding-bottom:1em;">
      <!-- Buttons for pass through -->
      <div class="col col-3" v-for="(isActive, inputName) in midi_input_active" :key="inputName">
        <button :class="{ active: isActive, inactive: !isActive }" @click="toggleActivation(inputName)"
          style="font-size:0.9em;">
          {{ inputName }} {{ isActive ? 'Active' : 'Inactive' }}
          {{ midi_input_last_message[inputName] }}
        </button>
      </div>
    </div>
    <div v-if=" !device_connected">
      <h3>Device not connected</h3>
    </div>
    <div v-else>
      <h3>Device connected</h3>
    </div>
    <!-- Scene Selection Dropdown -->
    <div class="dropdown">
      <label for="scene-select">Select Scene:</label>
      <select id="scene-select" v-model="current_scene">
        <option v-for="(scene, index) in scenes" :key="index" :value="index">
          Scene {{ index + 1 }}
        </option>
      </select>
    </div>


    <!-- Output Selection Buttons -->
    <!-- label for button row -->
    <h3>Outputs</h3>
    <div class="button-row row">
      <div class="col col-1" v-for="(output, index) in scenes[current_scene].outputs" :key="index">
        <button
          :class="[current_output !== index && 'inactive', current_output === index && 'active', getButtonClass(output.mode)]"
          @click="select_output(index)">
          {{ index + 1 }}
        </button>
      </div>
    </div>

    <!-- Output Details -->
    <div class="output-details" v-if="current_output !== null">
      <div class="row">
        <div class="col col-2 fr">
          <label for=" mode-select">Select Mode:</label>
        </div>
        <div class="col col-10">
          <select id="mode-select" v-model="selected_output.mode">
            <option value=0>Manual</option>
            <option value=1>MIDI Pitch</option>
            <option value=2>MIDI Envelope</option>
            <option value=3>MIDI CC</option>
            <option value=4>MIDI Clock</option>
            <option value=5>Clock</option>
            <option value=6>LFO</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="col col-2 fr">
          <label>
            Voltage min:
          </label>
        </div>
        <div class="col col-4">
          <input type="number" v-model.number="selected_output.min_voltage" min="-5" max="10" step="0.01" />
        </div>
        <div class="col col-2 fr">
          Voltage max:
        </div>
        <div class="col col-4">
          <input type="number" v-model.number="selected_output.max_voltage" min="-5" max="10" step="0.01" />
        </div>
      </div>
      <div class="row" v-if="Number(selected_output.mode) === 0">
        <div class="col col-2 fr">
          <label for="slew-rate">Slew:</label>
        </div>
        <div class="col col-4">
          <input id="slew-rate" type="number" v-model.number="selected_output.slew_time" />
        </div>
        <div class="col col-2 fr">
          <label for="portamento">Portamento:</label>
        </div>
        <div class="col col-4">
          <input id="portamento" type="number" v-model.number="selected_output.portamento" />
        </div>
      </div>
      <!-- lfo stuff -->
      <div class="row" v-if="[6].includes(Number(selected_output.mode))">
        <div class="col col-2 fr">
          <label for="lfo-waveform">
            LFO waveform:
          </label>
        </div>
        <div class="col col-2">
          <select id="lfo-waveform" v-model="selected_output.lfo_waveform">
            <option value=0>Sine</option>
            <option value=1>Triangle</option>
            <option value=2>Sawtooth</option>
            <option value=3>Square</option>
            <option value=4>Drunk</option>
          </select>
        </div>
        <div class="col col-2 fr">
          <label for="lfo-period">
            Period:
          </label>
        </div>
        <div class="col col-2">
          <input id="lfo-rate" type="number" v-model.number="selected_output.lfo_period" min="0.1" max="10"
            step="0.1" />
        </div>
        <div class="col col-2 fr">
          <label for="lfo-depth">
            Depth:
          </label>
        </div>
        <div class="col col-2">
          <input id="lfo-depth" type="number" v-model.number="selected_output.lfo_depth" min="0" max="1" step="0.01" />
        </div>
      </div>

      <div class="row" v-if="[0, 1,2,6].includes(Number(selected_output.mode))">
        <div class="col col-2 fr">
          <label for="quantization">
            Quantize:
          </label>
        </div>
        <div class="col col-4">
          <select id="quantization" v-model="selected_output.quantization">
            <option value=0>None</option>
            <option value=1>Chromatic</option>
            <option value=2>Major</option>
            <option value=3>Natural Minor</option>
            <option value=4>Harmonic Minor</option>
            <option value=5>Melodic Minor</option>
            <option value=6>Dorian</option>
            <option value=7>Phrygian</option>
            <option value=8>Lydian</option>
            <option value=9>Mixolydian</option>
            <option value=10>Locrian</option>
            <option value=11>Whole Tone</option>
            <option value=12>Major Pentatonic</option>
            <option value=13>Minor Pentatonic</option>
            <option value=14>Major Bebop</option>
            <option value=15>Altered Scale</option>
            <option value=16>Dorian Bebop</option>
            <option value=17>Mixolydian Bebop</option>
            <option value=18>Blues Scale</option>
            <option value=19>Diminished Whole Half</option>
            <option value=20>Diminished Half Whole</option>
            <option value=21>Neapolitan Major</option>
            <option value=22>Hungarian Major</option>
            <option value=23>Harmonic Major</option>
            <option value=24>Hungarian Minor</option>
            <option value=25>Lydian Minor</option>
            <option value=26>Neapolitan Minor</option>
            <option value=27>Major Locrian</option>
            <option value=28>Leading Whole Tone</option>
            <option value=29>Six Tone Symmetrical</option>
            <option value=30>Balinese</option>
            <option value=31>Persian</option>
            <option value=32>East Indian Purvi</option>
            <option value=33>Oriental</option>
            <option value=34>Double Harmonic</option>
            <option value=35>Enigmatic</option>
            <option value=36>Overtone</option>
            <option value=37>Eight Tone Spanish</option>
            <option value=38>Prometheus</option>
            <option value=39>Gagaku Rittsu Sen Pou</option>
            <option value=40>In Sen Pou</option>
            <option value=41>Okinawa</option>
          </select>
        </div>
        <div class="col col-1 fr">
          <label for="v_oct" :class="{ grayed: Number(selected_output.quantization) === 0 }">
            V/Oct:
          </label>
        </div>
        <div clas="col col-1">
          <input id="v_oct" type="number" :disabled="Number(selected_output.quantization) === 0"
            v-model.number="selected_output.v_oct" min="-5" max="10" step="0.01" />
        </div>
        <div class="col col-1 fr">
          <label for="root_note" :class="{ grayed: Number(selected_output.quantization) === 0 }">
            Root:
          </label>
        </div>
        <div class="col col-2">
          <select id="root_note" :disabled="Number(selected_output.quantization) === 0"
            v-model.number="selected_output.root_note">
            <option v-for="(name, index) in note_names" :key="index" :value="index">
              {{ name }}
            </option>
          </select>
        </div>
      </div>
      <!-- midi stuff -->
      <div class="row" v-if="[3].includes(Number(selected_output.mode))">
        <div class="col col-2 fr">
          <label for="midi-cc">
            MIDI CC:
          </label>
        </div>
        <div class="col col-10">
          <input id="midi-cc" type="number" v-model.number="selected_output.midi_cc" min="0" max="16" />
        </div>
      </div>
      <!-- midi stuff -->
      <div class="row" v-if="[1,2,3].includes(Number(selected_output.mode))">
        <div class="col col-2 fr">
          <label for="midi-channel">
            MIDI Channel:
          </label>
        </div>
        <div class="col col-4">
          <select id="midi-channel" v-model="selected_output.midi_channel">
            <option value=0>Any</option>
            <option value=1>Channel 1</option>
            <option value=2>Channel 2</option>
            <option value=3>Channel 3</option>
            <option value=4>Channel 4</option>
            <option value=5>Channel 5</option>
            <option value=6>Channel 6</option>
            <option value=7>Channel 7</option>
            <option value=8>Channel 8</option>
            <option value=9>Channel 9</option>
            <option value=10>Channel 10</option>
            <option value=11>Channel 11</option>
            <option value=12>Channel 12</option>
            <option value=13>Channel 13</option>
            <option value=14>Channel 14</option>
            <option value=15>Channel 15</option>
            <option value=16>Channel 16</option>
          </select>
        </div>
        <div class="col col-2 fr">
          <label for="midi-priority-channel">
            MIDI Priority:
          </label>
        </div>
        <div class="col col-4">
          <select id="midi-priority-channel" v-model="selected_output.midi_priority_channel">
            <option value=0>None</option>
            <option value=1>Channel 1</option>
            <option value=2>Channel 2</option>
            <option value=3>Channel 3</option>
            <option value=4>Channel 4</option>
            <option value=5>Channel 5</option>
            <option value=6>Channel 6</option>
            <option value=7>Channel 7</option>
            <option value=8>Channel 8</option>
            <option value=9>Channel 9</option>
            <option value=10>Channel 10</option>
            <option value=11>Channel 11</option>
            <option value=12>Channel 12</option>
            <option value=13>Channel 13</option>
            <option value=14>Channel 14</option>
            <option value=15>Channel 15</option>
            <option value=16>Channel 16</option>
          </select>
        </div>
      </div>


      <!-- clock stuff -->
      <div class="row" v-if="[5].includes(Number(selected_output.mode))">
        <div class="col col-2 fr">
          <label for="clock-tempo">
            Clock tempo:
          </label>
        </div>
        <div class="col col-10">
          <input id="clock-tempo" type="number" v-model.number="selected_output.clock_tempo" min="15" max="300" />
        </div>
      </div>
      <div class="row" v-if="[4,5].includes(Number(selected_output.mode))">
        <div class="col col-2 fr">
          <label for="clock-divider">
            Clock division:
          </label>
        </div>
        <div class="col col-10">
          <select id="clock-divider" v-model="selected_output.clock_division">
            <!-- clockDivisions for loop -->
            <option v-for="(clockDivision, index) in clockDivisions" :key="index" :value="index">
              {{ clockDivision }}
            </option>
          </select>
        </div>

      </div>
    </div>
  </div>

  <script src="/static/app.js"></script>
</body>

</html>